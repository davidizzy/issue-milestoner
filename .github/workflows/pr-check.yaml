name: PR Check - Orchestrator
on:
  pull_request:
    types: [opened, synchronize, reopened]
permissions:
  contents: read
  issues: write
  pull-requests: read
jobs:
  test-issue-milestoner:
    name: Test Issue Milestoner
    uses: ./.github/workflows/test-issue-milestoner.yaml
    with:
      pr_number: ${{ github.event.pull_request.number }}
      pr_author: ${{ github.event.pull_request.user.login }}
      pr_url: ${{ github.event.pull_request.html_url }}
      pr_branch: ${{ github.event.pull_request.head.ref }}
      pr_commit: ${{ github.event.pull_request.head.sha }}
    secrets: inherit
  report-results:
    name: Report PR Check Results
    runs-on: ubuntu-latest
    needs: [test-issue-milestoner]
    if: always()
    steps:
      - name: Report overall results
        run: |-
          test_result="${{ needs.test-issue-milestoner.result }}"

          echo "## PR Check Results"
          echo "- **Issue Milestoner Test**: $test_result"

          if [[ "$test_result" == "success" ]]; then
            echo ""
            echo "ğŸ‰ **All checks passed!** This PR is ready for review."
            exit 0
          else
            echo ""
            echo "âŒ **Test failed.** Please review the failed job above."
            exit 1
          fi
